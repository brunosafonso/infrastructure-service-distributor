# Nginx configuration for both HTTP and SSL

map $http_upgrade $connection_upgrade {
	default upgrade;
	'' close;
}

server {

	listen					80;

	resolver ${DNS_SERVER} valid=5s;
	server_name ${SERVER_NAME};

	location / {
		index index.html index.htm;
		root /usr/share/nginx/html;
#		root /etc/nginx/;
#		autoindex on;
#		allow all;
	}

	location /healthz {
		access_log off;
		add_header Content-Type text/plain;
		return 200 "OK";
	}

	location /metrics/nginx {
		access_log off;
		proxy_store off;
		stub_status;
	}

	error_page 500 502 503 504  /50x.html;
	location = /50x.html {
		root /usr/share/nginx/html;
	}
}